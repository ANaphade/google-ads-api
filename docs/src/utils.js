import React from 'react'
import Section from './components/section'

export const getSectionId = node => {
    const { title } = node.frontmatter
    return `${node.fields.directory.split('/').join('-')}-${title.split(' ').join('-')}`
}

export const getIds = edges => {
    return edges.map(edge => {
        const { node } = edge
        return getSectionId(node)
    })
}

export const getSections = edges => {
    return edges.map(edge => {
        const { node } = edge

        /* node.frontmatter holds all variables from MD file
            ---
                title: abc
                json: zxc
            ---
            we can pass anything we need there
        */

        // const { title } = node.frontmatter

        // we get autogenerated object from meta.js which should always exist for each entity
        const meta = require(`../content/${node.fields.directory}/meta.js`)
        // we access meta object property by json key specified in md file
        // const json_print = JSON.stringify(meta, null, 2)
        // this json print is temp. but we can pass it to a component
        // which will create a nice table from it

        const id = getSectionId(node)
        // generating id of the section to use in links
        // in format: '#entities-account_budget-create'
        return (
            <Section id={id} key={edge.node.id} node={node} meta={meta}>
                {/* <h3>{title}</h3>
                <div dangerouslySetInnerHTML={{ __html: edge.node.html }} />
                <div>
                    <pre>{json_print}</pre>
                </div>
                <hr /> */}
            </Section>
        )
    })
}
